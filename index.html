<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" type="text/css" href="stylesheet/energy.css" />
<title>Energy Calculator</title>
<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <script type="text/javascript"
      src="http://maps.googleapis.com/maps/api/js?key=AIzaSyAZU3-xCpzg-ru4WOCzl1n9RNssVY9j55A&sensor=false">
    </script>
    <script type="text/javascript" src="js/incrementing.js"></script>
	<script type="text/javascript">
		var focusCircle;
		var focusInfoWindow;
		
		function initialize() {
	    	var myOptions = {
	    		center: new google.maps.LatLng(37.8717, -122.2728),
	      		zoom: 14,
	      		mapTypeId: google.maps.MapTypeId.ROADMAP
	    	};
	    	var map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
	    	google.maps.event.addListener(map, 'click', 
	    		function(event) { 
	    			placeMarker(event.latLng, map);
	    		}
	    	);
	    	focusCircle = new google.maps.Circle({
				clickable: false,
				map: map,
				visible: false
			});
			updateCircleRadius();
		}
		
		function placeMarker(position, map) {
			if (focusInfoWindow) {
				focusInfoWindow.close();
			}
			var marker = new google.maps.Marker({
				position: position,
			    map: map,
			    draggable: true,
			    title: "Latitude: " + position.lat() + "; Longitude: " + position.lng()
			});
			var contentString = "Pending...";
			var infoWindow = new google.maps.InfoWindow({
				content: contentString
			});
			focusInfoWindow = infoWindow;
			focusCircle.bindTo("center", marker, "position");
			focusCircle.setVisible(true);
			infoWindow.open(map,marker);
			google.maps.event.addListener(marker, "click", 
				function() {
					if (focusInfoWindow) {
						focusInfoWindow.close();
					}
					infoWindow.open(map,marker);
					focusInfoWindow = infoWindow;
					focusCircle.bindTo("center", marker, "position");
					focusCircle.setVisible(true);
				}
			);
			google.maps.event.addListener(marker, "rightclick", 
				function (marker) {
					this.setMap(null);
					focusInfoWindow.close();
					infoWindow.close();
					infoWindow.setMap(null);
					focusCircle.setVisible(false);
				}
			);
			map.panTo(position);
			
			if (window.XMLHttpRequest) {// code for IE7+, Firefox, Chrome, Opera, Safari
				xmlhttp=new XMLHttpRequest();
			} else { // code for IE6, IE5
				xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
			}
			xmlhttp.onreadystatechange=
				function() {
			  		if (xmlhttp.readyState==4 && xmlhttp.status==200) {
			    		contentString = xmlhttp.responseText;
			    		infoWindow.setContent(contentString);
			    	}
			  	}
			xmlhttp.open("POST", "request_house_data.php", true);
			xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
			var radius = document.getElementById("radius").value;
			xmlhttp.send("latitude=" + position.lat() + "&longitude=" + position.lng() + "&radius=" + radius + "&bedrooms" + document.getElementById("bedrooms").checked + "&houses=" + document.getElementById("houses").checked + "&address=" + document.getElementById("address").checked + "&house_size=" + document.getElementById("house_size").checked + "&lot_size=" + document.getElementById("lot_size").checked + "&br=" + document.getElementById("br").checked + "&bathrooms=" + document.getElementById("bathrooms").checked + "&year_built=" + document.getElementById("year_built").checked);
		}
		
		function updateCircleRadius() {
			focusCircle.setRadius(document.getElementById("radius").value * 1609.344);
		}
    </script>
</head>
<body onLoad="initialize()" style="background: rgb(255, 255, 255) url(images/012008_background.jpg) repeat scroll top left; margin: 0pt;">

<div id="options">
   <h3 align="center">Options to desplay on info windows</h3>
   <br/>
   		<div>
   			Radius (mi): <input type="text" name="radius" id="radius" value="0.5" onChange="updateCircleRadius()" /> <br/><br/>
        </div>
        <div>
        	<input type="checkbox" name="bedrooms" id="bedrooms" checked="yes"> Nearby Bedrooms<br/><br/>   
        </div>
        <div>
        	<input type="checkbox" name="houses" id="houses" checked="yes"> Number of Buildings<br/><br/>   
        </div>
   		<div>
        	<input type="checkbox" name="address" id="address" checked="yes"> Address of the closest house<br/><br/>
        </div>
        <div>
        	<input type="checkbox" name="house_size" id="house_size" checked="yes"> House Size of the closest house<br/><br/>
        </div>
        <div>
        	<input type="checkbox" name="lot_size" id="lot_size" checked="yes"> Lot Size of the closest house<br/><br/>
        </div>
        <div>
        	<input type="checkbox" name="br" id="br" checked="yes"> Number of Bedrooms for the closest house<br/><br/>
        </div>
        <div>
        	<input type="checkbox" name="bathrooms" id="bathrooms" checked="yes"> Number of Bedrooms for the closest house<br/><br/>
        </div>
        <div>
        	<input type="checkbox" name="year_built" id="year_built" checked="yes"> Year the closest house was built<br/><br/>
        </div>
   <br>
   		
</div>
<div id="main">
	<h1 align="center"> Energy Calculator </h1>
	<p align="center"> Please input a longitude and latitude </p>
    
    <center><div id="latlong">
		<form method="post" action="posting.php">
			Longitude: <input type="text" name="longitude" /> 
			Latitude: <input type="text" name="latitude" />
            Address: <input type="text" name="address" />
			<input type="submit" value ="Submit" name="Submit"/>
		</form>
	</div></center>
    <div id="map_canvas" style="width:730px; height:600px;"></div>
    <center><a href="index.html">Remove all Placemarks</a></center>
</div>



</body>
</html>

